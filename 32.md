NIP-32
======

标记
----

`草案` `可选` `作者:staab` `作者:gruruya` `作者:s3x-jay`

标记是一个 `kind 1985` 事件，用于标记其他实体。这支持多种用例，从分布式节制和内容推荐到评论和评分。

标记目标
--------

标记事件**必须**包含一个或多个代表被标记的对象或被标记对象的标签：`e`，`p`，`a`，`r`，或 `t` 标签。这允许对事件、人、中继、或主题进行标记。与 NIP-01 一样，当使用 `e` 和 `p` 标签时，应包含中继提示。

标记标签
--------

此 NIP 引入了一个新的标签 `l`，表示被一个标记，和一个新的 `L` 标签，表示一个标记命名空间。
标记**必须**包含一个与 `L` 标签相匹配的记号。`L` 标签指的是 nostr 中的一个标签类型，或者是在 nostr 之外定义的无论是正式的还是约定的命名法。任何字符串都可以是命名空间，但发布者**应该**通过使用一个定义良好的命名空间（如 ISO 标准）或反向域名表示法来确保它们是无歧义的。

以 `#` 开头的命名空间表示应将标记目标与标记的值关联起来。
这是一种将标准的 nostr 标签附加到事件、公钥、中继、url 等的方法。

一些例子：

- `["l", "footstr", "#t"]` - 发布者认为给定的实体应该应用 `footstr` 主题。
- `["l", "<pubkey>", "#p"]` - 发布者认为给定的实体与 `<pubkey>` 有关
- `["l", "IT-MI", "ISO-3166-2"]` - 使用 ISO 3166-2 意大利米兰。
- `["l", "VI-hum", "com.example.ontology"]` - 根据 ontology.example.com 定义的针对人类的暴力行为。

包含标记命名空间的 `L` 标签**必须**存在，以支持通过命名空间而不是特定标签进行搜索。当标记内容由最终用户提供时，**可以**使用特殊的 `ugc`（“用户生成的内容”）命名空间。

`l` 和 `L` 标签**可以**被添加到其他事件类型，以支持自我报告。对于除类型 1985 之外其他类型的事件，标记指向事件自身。

标记注解
--------

标记标签**可以**包含一个第四位置的元素，详细阐明有关该标记的额外元数据。这个字符串应该是一个 json 编码的对象。可以使用任何键，但建议使用以下键：

- `quality` 可能的值为 0 到 1。这允许一个绝对的、粒度的比例，可以以任何方式表示（5 星，颜色比例等）。
- `confidence` 可能的值为 0 到 1。这表示作者对他们的评分的确信程度。
- `context` 可能是一个 url 数组（包括 NIP-21 url），表示在解释标记时应考虑的其他上下文。

内容
----

标记应该是短的、有意义的字符串。长的讨论比如评论，或解释为什么某物被加上某个标记，应该放在事件的 `content` 字段中。

示例事件
--------

一个将多个公钥与 `permies` 主题关联起来的建议。

```json
{
  "kind": 1985,
  "tags": [
    ["L", "#t"],
    ["l", "permies", "#t"],
    ["p", <pubkey1>, <relay_url>],
    ["p", <pubkey2>, <relay_url>]
  ],
  "content": "",
  ...
}
```

对某中继的一个评价。

```json
{
  "kind": 1985,
  "tags": [
    ["L", "com.example.ontology"],
    ["l", "relay/review", "com.example.ontology", "{\"quality\": 0.1}"],
    ["r", <relay_url>]
  ],
  "content": "This relay is full of mean people.",
  ...
}
```

发布者可以通过在自己的非 1985 事件中添加 `l` 标签来进行自我标记。

```json
{
  "kind": 1,
  "tags": [
    ["L", "com.example.ontology"],
    ["l", "IL-frd", "com.example.ontology"]
  ],
  "content": "Send me 100 sats and I'll send you 200 back",
  ...
}
```

其他注意事项
------------

当使用此 NIP 一次性批量标记多个目标时，事件可能会被删除并被替换。由于制定标准 `d` 标签的复杂性，我们选择不使用可参数化/可替换的事件。为了避免查询时的歧义，发布者**应该**将标记事件限制在单一的命名空间。

在创建词汇表之前，探索你的用例可能已经被设计出来的方式，并尽可能模仿那种设计。鼓励使用反向域名表示法来避免命名空间冲突，但为了互操作性，所有命名空间都应被视为公开供公众使用，而不是专有的。换句话说，如果有一个适合你的用例的命名空间，即使它指向别人的域名，也应该使用它。

词汇表**可以**选择完全符合某个命名空间内的所有标记（例如，`["l", "com.example.vocabulary:my-label"]`）。当定义更正式的词汇表时，这可能是首选，这些词汇表在没有 `L` 标签的查询中不应与其他命名空间混淆。对于这些词汇表，所有标记都**应该**包含命名空间（而不是混合符合和未符合的标签）。
