NIP-10
======

关于文本事件（类型 1）中的“e”和“p”标签
--------------------------------------

`草案` `可选` `作者:unclebobmartin`

## 摘要
本 NIP 描述了如何在文本事件中使用“e”和“p”标签，特别是那些回复其他文本事件的事件。它帮助客户端将回复线程化为以原始事件为根的树。

## 位置“e”标签（已弃用）

> 此方案虽已被广泛使用；但应被视为已弃用。

`["e", <event-id>, <relay-url>]` 根据 NIP-01。

其中：

 * `<event-id>` 是被引用事件的 id。
 * `<relay-url>` 是与引用关联的推荐中继的 URL。许多客户端将此字段视为可选。

**事件内“e”标签的位置表示特定的含义，如下所示**：

 * 没有“e”标签：<br>
 该事件不是对任何其他事件的回复，也不引用任何其他事件。

 * 一个“e”标签：<br>
 `["e", <id>]`：该事件所回复的事件的事件 id。

 * 两个“e”标签：`["e", <root-id>]`, `["e", <reply-id>]` <br>
 `<root-id>` 是回复链根部事件的事件 id。`<reply-id>` 是该事件所回复的事件的事件 id。

 * 许多"e"标签：`["e", <root-id>]` `["e", <mention-id>]`, ..., `["e", <reply-id>]`<br>
可能有任意数量的 `<mention-ids>`。这些是可能在回复链中，也可能不在回复链中的事件的 ids。
它们是该事件的引用。`root-id` 和 `reply-id` 如前述。

> 此方案已弃用，因为当一个事件不是回复的方式引用另一个事件时，这会创建难以或无法解决的歧义。

## 标记的“e”标签（首选）

`["e", <event-id>, <relay-url>, <marker>]`

其中：

 * `<event-id>` 是被引用事件的 id。
 * `<relay-url>` 是与引用关联的推荐中继的 URL。客户端应添加一个有效的 `<中继-URL>` 字段，但也可以将其留为空 `""`。
 * `<marker>` 是可选的，如果存在则是 `"reply"`，`"root"`，或 `"mention"` 中的一个。

标记为 `"reply"` 时表示为被回复事件的 id。标记为 `"root"` 时表示为被回复根事件的 id。对于顶级回复（直接回复根事件的），应只使用 `"root"` 标记。标记为 `"mention"` 时表示被引用或转发事件的 id。

直接回复线程的根应当仅有一个类型为“root”的“e”标签。

> 首选此方案，因为它允许事件提及其他事件，而不会将它们与 `<reply-id>` 或 `<root-id>` 混淆。

## “p”标签

用于文本事件包含一个用于记录谁参与回复线程的公钥列表。

回复文本事件 E 时，回复事件的“p”标签应包含所有的 E 的“p”标签以及被回复事件的 `"pubkey"`。

示例：给定一个由 `a1` 编写的文本事件，其“p"标签为 [`p1`, `p2`, `p3`]，那么回复的“p”标签应为 [`a1`, `p1`, `p2`, `p3`] 顺序不定。
