NIP-65
======

中继列表元数据
--------------

`草案` `可选` `作者:mikedilger` `作者:vitorpamplona`

定义了一种 `kind:10002` 可替换事件，用于宣传发现用户内容和接收他人新内容的首选中继。

事件**必须**包含一系列带有中继 URI 和 `read` 或 `write` 记号的 `r` 标签。如果省略，那么默认中继支持两种。

`.content` 不被使用。

```json
{
  "kind": 10002,
  "tags": [
    ["r", "wss://alicerelay.example.com"],
    ["r", "wss://brando-relay.com"],
    ["r", "wss://expensive-relay.example2.com", "write"],
    ["r", "wss://nostr-relay.example.com", "read"],
  ],
  "content": "",
  ...其它字段
```

此 NIP 并未完全取代设计用于配置客户端使用中继的中继列表（如 `kind:3` 类型的中继列表）。在找不到 `kind:10002` 中继列表的情况下，客户端**可以**使用其他中继列表。

## 读和写时机

当从用户那里寻找事件时，客户端**应该**使用用户的 `kind:10002` 的**写**中继。

当寻找关于用户的事件，即用户被标记的地方，客户端**应该**使用用户的 `kind:10002` 的**读**中继。

当广播一个事件时，客户端**应该**：

- 将事件广播到作者的**写**中继
- 将事件广播到每个被标记用户的所有**读**中继。

## 动机

旧的模式是使用每个用户固定的中继列表，这在大型中继运营商中产生了集中化：

- 大多数用户将他们的帖子提交到相同的高度流行的中继，以便在更广泛的受众中获得更大的可见度。
- 许多用户从大量的中继中拉取事件，以获取更多的数据，但付出了内容重复的代价
- 事件在中继之间复制，往往是在许多不同的中继

此 NIP 允许客户端直接与每个单独用户最新的中继集合连接，消除了向流行中继广播事件的需要。

## 最后的考虑

1. 客户端**应该**指导用户保持 `kind:10002` 列表的小（2-4 个中继）。

2. 客户端**应该**将作者的 `kind:10002` 事件传播到尽可能多的中继。

3. `kind:10002` 事件主要应用于向其他人宣传用户首选的中继。用户自己的客户端可能会使用其他启发式方法来选择获取数据的中继。

4. 私信**应该**仅广播到作者的**写**中继和接收者的**读**中继，以保持最大的隐私。

5. 如果中继在他们的 [NIP-11](11.md) 文档中表示支持此 NIP，那就意味着他们愿意接受来自广泛用户的 10002 类型事件，而不仅仅是他们的付费客户或白名单组。

6. 客户端*应该***根据 [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986#section-6) 规范化中继 URI 以消除重复的连接。
