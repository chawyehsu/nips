NIP-50
======

搜索能力
--------

`草案` `可选` `作者:brugeman` `作者:mikedilger` `作者:fiatjaf`

## 摘要

许多 Nostr 使用案例需要某种形式的通用搜索功能，除了通过标签或 id 进行结构化查询。
搜索算法的具体细节将在事件类型之间有所不同，此 NIP 仅描述了执行此类查询的通用可扩展框架。

## `search` 过滤字段

为来自客户端的 `REQ` 消息引入了新的 `search` 字段：

```json
{
  ...
  "search": <string>
}
```

`search` 字段是一个以人类可读形式描述查询的字符串，例如“best nostr apps”。中继**应该**尽其所能解释查询并返回匹配的事件。中继**应该**对 `content` 事件字段进行匹配，如果在特定类型的上下文中有意义，也**可以**对其他字段进行匹配。

查询字符串可能包含 `key:value` 对（由冒号分隔的两个单词），这些是扩展，中继**应该**忽略它们不支持的扩展。

客户端可以指定多个搜索过滤器，例如 `["REQ", "", { "search": "orange" }, { "kinds": [1, 2], "search": "purple" }]`。客户端可以包含 `kinds`，`ids` 和其他过滤字段，以将搜索结果限制在特定事件类型。

客户端**应该**使用 supported_nips 字段来了解中继是否支持 `search` 过滤器。如果客户端已准备过滤来自不支持此 NIP 中继的多余响应，它们也**可以**向任何中继发送 `search` 过滤器查询。

客户端**应该**查询支持此 NIP 的多个中继，以补偿中继之间可能存在的不同实现细节。

客户端**可以**验证中继返回的事件是否以适合客户端用例的方式匹配指定的查询，并可以停止查询精度低的中继。

如果中继支持某种形式的垃圾信息过滤，那么默认情况下**应该**从搜索结果中排除垃圾信息。

## 扩展

中继**可以**支持这些扩展：
- `include:spam` - 如果默认启用，则关闭垃圾信息过滤
